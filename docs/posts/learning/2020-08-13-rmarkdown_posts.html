
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Rmarkdown (nice) posts &#8212; PJnotes 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/pj_touch.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="IBM Containers and Kubernetes" href="2021-08-04-IBM_containers.html" />
    <link rel="prev" title="Web places that I love" href="../../recommendations.html" />
   
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
  <link rel="stylesheet" href="../../_static/css/pj_print.css" media="print", type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  </head><body>
    <header>
        <div class="logo-box">
            <svg height="70" width="26">
            <path d="M 3 59
                     l 0 -42
                     A 10 10 1 0 1 23 17
                     l 0 37
                     A 7 7 1 0 1 9 54
                     l 0 -30
                     A 5 5 1 0 1 19 24
                     l 0 20" stroke="black" stroke-width="2" fill="none"/>
            </svg>
            <a href="../../index.html">Prophet<br>Jeremy's<br>
                <span style="font-family:PT Serif Caption; color:var(--special-words); font-size:20px">
                    notes
                </span>
            </a>
        </div>
        <input id="nav-toggle" type="checkbox" class="nav-toggle">
        <nav>
            <ul>
                <li><a href=../../cv.html>CV</a></li>
                <li><a href=../../about.html>About</a></li>
                <li><a href=../../recommendations.html>Recommendations</a></li>
            </ul>
        </nav>
        <label for="nav-toggle" class="nav-toggle-label">
            <span class="nav-toggle-m1 nav-toggle-mvert"></span>
            <span class="nav-toggle-m2 nav-toggle-mdiag"></span>
            <span class="nav-toggle-m3 nav-toggle-mdiag"></span>
            <span class="nav-toggle-m4 nav-toggle-mvert"></span>
        </label>
    </header>
    <div class="container">
        
        <input id="sidebar-toggle" type="checkbox" class="sidebar-toggle">
        <div class="sidebar">



<h3>Navigate: 
      <a href="../../recommendations.html" title="previous document">&lArr;</a>
      <a href="2021-08-04-IBM_containers.html" title="next document">&rArr;</a></h3>
<div class="toc">
    <ul>
<li><a class="reference internal" href="#">Rmarkdown (nice) posts</a><ul>
<li><a class="reference internal" href="#same-toc">Same TOC</a></li>
<li><a class="reference internal" href="#nice-alerts">Nice alerts</a></li>
<li><a class="reference internal" href="#pictures">Pictures</a></li>
</ul>
</li>
</ul>

</div>
<script src="../../_static/js/toc.js"></script>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search:</h3>
  <form class="search" action="../../search.html" method="get">
      <input class="search-box" type="text" name="q" aria-labelledby="searchlabel" />
      <input class="search-button" type="submit" value="&lt;" />
  </form>
</div>
<script>$('#searchbox').show(0);</script>

<hr>
<div class="social-icons">
    
    <a href="mailto:santibreo@gmail.com?subject=We want to hire you">
        <i class="fa fa-envelope"></i>
    </a>
    
    
    <a href=https://github.com/santibreo><i class="fab fa-github"></i></a>
    
    <a href=https://twitter.com/santibreo><i class="fab fa-twitter"></i></a>
    
    <a href=https://www.linkedin.com/in/santibreo/><i class="fab fa-linkedin"></i></a>
    
</div>
<hr>
</div>
        <label for="sidebar-toggle" class="sidebar-toggle-label">
            <span></span>
        </label>
        
        <div class="content">
        
  <section id="rmarkdown-nice-posts">
<h1>Rmarkdown (nice) posts<a class="headerlink" href="#rmarkdown-nice-posts" title="Permalink to this headline"> &sect;</a></h1>
<p>In this post I am going to explain how I have prepared my Rmarkdown posts to
look exactly as the standard Markdown posts. It is not as straightforward as
you could suppose because Rmarkdown is becoming a framework fast, you need to
look the documentation for <a class="reference external" href="https://bookdown.org/yihui/blogdown/">blogdown</a>,
<a class="reference external" href="https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html">html sites</a> and
<a class="reference external" href="https://www.bookdown.org/">bookdown</a>, and then find the logic that is hidden
behind.</p>
<section id="same-toc">
<h2>Same TOC<a class="headerlink" href="#same-toc" title="Permalink to this headline"> &sect;</a></h2>
<p>I love my nice-looking Table Of Contents which I have found in the Internet.
I had to make minimal changes in the javascript (I know no javascript) to make
that worm behave exactly as I want. Of course I have read the way of <a class="reference external" href="https://bookdown.org/yihui/blogdown/templates.html#how-to">dealing
with this suggested by Yihui</a>,
and then, when I was thinking it was time to start writing, I watched that uggly
TOC that was added to my Rmarkdown posts, and I could not hold it. So I start
thinking about possible solutions:</p>
<ol class="arabic">
<li><p>[<strong>FAIL</strong>] - In Rmarkdown files the TOC is in an html tag with
<cite>id=’toc’</cite>. In the Markdown files I have absolute control of where it is
going to appear, so I can just give in my css the same properties to both,
the <cite>.toc</cite> class and the <cite>#toc</cite> id, and that was my first approach, but it
did not work. The TOC created for Markdown files was inside a <cite>nav</cite> and the
Rmarkdown one was not. Furthermore, the javascript worm is getting the
<cite>.toc</cite> class, and I am not confortable making more and more changes in the
javascript. So I leave this way back where I started.</p></li>
<li><p>[<strong>FAIL</strong>] - I was reading a lot of issues asking Yihui for the <cite>toc_float</cite> parameter
support in blogdown, so I started feeling that a decent workaround should be
somewhere. I found <a class="reference external" href="https://www.garrickadenbuie.com/blog/add-a-generated-table-of-contents-anywhere-in-rmarkdown/">this post</a>
talking about how to create the TOC anywhere inside your Rmarkdown file
using and R function. I thought, <em>okey, I just have to edit the function,
so it creates the html code instead of markdown</em>. I have some experience
doing this kind of <em>hacking</em> (look [here](#toc_Nice-alerts)) so I accepted
the challenge, but this attempt implies a high dependence on regular
expressions, for which I have great appreciation, but I did not feel that I
would have sufficient control over the input text to adopt this solution.</p></li>
<li><p>[<strong>SUCCESS</strong>] - The last solution gave me the idea of just getting the <cite>h1</cite>,
<cite>h2</cite>, <cite>h3</cite>, <cite>h4</cite>, <cite>h5</cite> and <cite>h6</cite> tags of my html and create the TOC using
javascript. I found it done somewhere so I have just taken it and used it.
In a near future I should improve it because I have found it a bit
intricate, but by this moment I was desperate so I just wanted a working
solution.</p>
<p>So, how does it work: I just use a different parameter
(<cite>with_toc</cite>) to indicate if I want TOC or not. Then the mechanism is the
same as it was when using the Hugo <cite>.TableOfContents</cite> approach (suggested
for Markdown files) but calling a javascript function that creates the TOC
list inside the corresponding <cite>nav</cite> tag. The <cite>svg</cite> tag that will become the
worm is underneath so that’s all, it works perfectly.</p>
</li>
</ol>
</section>
<section id="nice-alerts">
<h2>Nice alerts<a class="headerlink" href="#nice-alerts" title="Permalink to this headline"> &sect;</a></h2>
<p>One of the things that I missed the most in the standard markdown and makes
me document my code (when using <a class="reference external" href="https://www.sphinx-doc.org/en/master/">Sphinx</a>)
with ReStructuredText is the nice alerts, notes and errors that you can put all
around. I find them really useful, and I can’t understand how markdown is not
supporting this. As when I decided to build up this blog I was already a
regular Rmarkdown user, I solved this to have that alerts in the notes that I
am writting about everything I learn. So the solution is pure Rmarkdown.</p>
<p>The idea is pretty simple, create a R function that returns the text given as
input as html, inside the <cite>divs</cite> with the corresponding <cite>alert</cite> class. As
R has already a <cite>message</cite>, <cite>warning</cite>, and <cite>stop</cite> function, I will just adapt
them for my purpose. Here is the code that I have used:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="c1"># Nice warnings, errors and messages</span>
<span class="linenos"> 2</span> <span class="n">knitr</span><span class="o">::</span><span class="n">knit_hooks</span><span class="o">$</span><span class="nf">set</span><span class="p">(</span>
<span class="linenos"> 3</span>     <span class="c1"># To watch error use error=T and stop function</span>
<span class="linenos"> 4</span>     <span class="n">error</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 5</span>         <span class="nf">paste</span><span class="p">(</span><span class="s">&#39;\n\n&lt;div class=&quot;alert alert-danger&quot; style=&gt;&#39;</span><span class="p">,</span>
<span class="linenos"> 6</span>               <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;##&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span>
<span class="linenos"> 7</span>                 <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;^##\ Error in eval\\(expr, envir, enclos\\):&#39;</span><span class="p">,</span>
<span class="linenos"> 8</span>                      <span class="s">&#39;&lt;i class=&quot;fas fa-skull&quot;&gt;&lt;/i&gt; **ERROR**: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span>
<span class="linenos"> 9</span>               <span class="s">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;\n&#39;</span><span class="p">)</span>
<span class="linenos">10</span>     <span class="p">},</span>
<span class="linenos">11</span>     <span class="c1"># To watch warning use warning function</span>
<span class="linenos">12</span>     <span class="n">warning</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">13</span>         <span class="nf">paste</span><span class="p">(</span><span class="s">&#39;\n\n&lt;div class=&quot;alert alert-warning&quot;&gt;&#39;</span><span class="p">,</span>
<span class="linenos">14</span>               <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;##&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span>
<span class="linenos">15</span>                    <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;^##\ Warning:&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;i class=&quot;fa fa-exclamation-triangle&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; **WARNING**: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span>
<span class="linenos">16</span>               <span class="s">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;\n&#39;</span><span class="p">)</span>
<span class="linenos">17</span>     <span class="p">},</span>
<span class="linenos">18</span>     <span class="c1"># To watch message use message function</span>
<span class="linenos">19</span>     <span class="n">message</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">20</span>         <span class="nf">paste</span><span class="p">(</span><span class="s">&#39;\n\n&lt;div class=&quot;alert alert-info&quot;&gt;&#39;</span><span class="p">,</span>
<span class="linenos">21</span>               <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;##&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span>
<span class="linenos">22</span>                    <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;^##\ &#39;</span><span class="p">,</span> <span class="s">&#39;&lt;i class=&quot;fas fa-comment-dots&quot;&gt;&lt;/i&gt; **INFO**: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span>
<span class="linenos">23</span>               <span class="s">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;\n&#39;</span><span class="p">)</span>
<span class="linenos">24</span>     <span class="p">},</span>
<span class="linenos">25</span>     <span class="n">class</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">envir</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">26</span>         <span class="nf">if</span><span class="p">(</span><span class="n">before</span><span class="p">){</span>
<span class="linenos">27</span>             <span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;&lt;div class = &#39;%s&#39;&gt;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">$</span><span class="n">class</span><span class="p">)</span>
<span class="linenos">28</span>         <span class="p">}</span><span class="n">else</span><span class="p">{</span>
<span class="linenos">29</span>             <span class="s">&quot;&lt;/div&gt;&quot;</span>
<span class="linenos">30</span>         <span class="p">}</span>
<span class="linenos">31</span>     <span class="p">}</span>
<span class="linenos">32</span> <span class="p">)</span>
</pre></div>
</div>
<p>Of course, I am using the <a class="reference external" href="https://fontawesome.com/icons?d=gallery">font-awesome icons</a>
only here, in my blogdown posts. For the standalone html created when you <cite>knit</cite>
your document I use Unicode symbos. You need to set the <cite>stop</cite> parameter of the
code chunk as <cite>TRUE</cite> to see the errors, and that’s all. The final alerts look
like:</p>
<div class="error admonition">
<p class="admonition-title">Cannot show up</p>
<p>This is what I am using now</p>
</div>
</section>
<section id="pictures">
<h2>Pictures<a class="headerlink" href="#pictures" title="Permalink to this headline"> &sect;</a></h2>
<p>The last function <cite>class</cite> in the code chunk is there because I use to add
pictures using R code, and when I do it, I want to be able to choose the html
<cite>div</cite> inside which they will be placed. So using the following code chunk:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">include_graphics</span><span class="p">(</span><span class="s">&quot;/path/to/your/image.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With parameters <cite>out.width = “70%”, class = “center-pic”</cite>, and having the
following class defined at my css:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">center-pic</span> <span class="nt">img</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span>
    <span class="k">margin-right</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span>
    <span class="k">margin-bottom</span><span class="p">:</span> <span class="mf">1.5</span><span class="kt">rem</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>I can have nice looking and centered standalone images. Now I can set the
images exactly as I want, using css code, which gives you a lot a freedom.</p>
<p>And that’s all, it could sound like not a big effort but for me, a beginner
with all this technologies, it was a bit challenging.</p>
</section>
</section>


        </div>
    </div>
    <div class="footer">&copy;2021, Prophet Jeremy.
       Powered by:&nbsp;<a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
       &nbsp;&amp;&nbsp;<a href="https://github.com/santibreo">PJnotes 1.0.0</a>
      
    </div>

    
  </body>
</html>